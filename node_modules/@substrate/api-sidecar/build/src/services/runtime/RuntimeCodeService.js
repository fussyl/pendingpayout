"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.RuntimeCodeService = exports.CODE_KEY = void 0;
const AbstractService_1 = require("../AbstractService");
// https://github.com/shawntabrizi/substrate-graph-benchmarks/blob/ae9b82f/js/extensions/known-keys.js#L21
exports.CODE_KEY = '0x3a636f6465';
class RuntimeCodeService extends AbstractService_1.AbstractService {
    /**
     * Fetch `Metadata` in decoded JSON form.
     *
     * @param hash `BlockHash` to make call at
     */
    async fetchCode(hash) {
        const { api } = this;
        const [code, { number }] = await Promise.all([
            api.rpc.state.getStorage(exports.CODE_KEY, hash),
            api.rpc.chain.getHeader(hash),
        ]);
        return {
            at: {
                hash,
                height: number.unwrap().toString(10),
            },
            code: code,
        };
    }
}
exports.RuntimeCodeService = RuntimeCodeService;
//# sourceMappingURL=RuntimeCodeService.js.map